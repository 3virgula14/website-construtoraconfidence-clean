---
import Footer from '../../components/Footer.astro';
import MainHead from '../../MainHead.astro';
import Nav from '../../components/Nav.astro';
import md from 'markdown-it';

import "./[...project].css"
import GlrImgItem from '../../components/GlrImgItem.astro';
import Placa from '../../components/Placa.astro';

  const feching = await fetch('https://construtoraconfidence.com/data.json').then((response) =>
    response.json()
  );

  const { project } = Astro.params;
  const data = feching['portfolio'][project]
---
<html lang="en">
	<MainHead/>
<body>
	<Placa/>

	<Nav/>

  <div id="img-galery" style={`--itemslength: ${data.sessions? data.sessions.length : 0}`}>
    {data.sessions && data.sessions.map( (session, i) => (
        <>
          <GlrImgItem session={session} i={i} width={(data.sessions? 100/(data.sessions.length/3) : 100)+"%"} height={(data.sessions? 100/(data.sessions.length/2) : 100)+"%"}/>
        </>
    ))}
  </div>

  <div class=" section content ">
    <h2>{data.titulo}</h2>

    {data.story && Object.keys(data.story).map((storyPart, index) => 
      <section class={storyPart}>
          <p set:html={md().render(data.story[storyPart])}></p>
      </section>
    )}
    
    {data.sessions && data.sessions.length>0 && 
      <>
      <h3>Registros</h3>
        {data.sessions.map( (session, i) => (
          session['mdsession'] && <section class="p_session">
            <div set:html={md().render(session['mdsession'])}/>
          </section>
        ))}
      </>
    }
  </div>

	<Footer></Footer>
</body>
</html>
